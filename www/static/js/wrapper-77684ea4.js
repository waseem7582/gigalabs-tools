var X=Object.defineProperty,Y=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var $=(t,e,o)=>e in t?X(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,h=(t,e)=>{for(var o in e||(e={}))J.call(e,o)&&$(t,o,e[o]);if(L)for(var o of L(e))Z.call(e,o)&&$(t,o,e[o]);return t},E=(t,e)=>Y(t,D(e));var I=(t,e,o)=>new Promise((i,r)=>{var a=d=>{try{c(o.next(d))}catch(l){r(l)}},n=d=>{try{c(o.throw(d))}catch(l){r(l)}},c=d=>d.done?i(d.value):Promise.resolve(d.value).then(a,n);c((o=o.apply(t,e)).next())});import{g as O}from"./storage-8434c3ff.js";import{aI as _,b as S,d as C,o as u,c as w,q as P,am as R,u as s,aJ as H,R as f,aK as x,aL as G,aM as q,E as y,aN as B,aO as N,W as j,F as A,O as m,j as p,m as ee,aP as g,ab as v,p as te,f as b,Q as k,aQ as W,aR as ne,S as oe}from"./index-5427279b.js";import{u as K}from"./useLifeHandler.hook-96539d1c.js";import{c as ie,u as re,C as se}from"./chartEditStore-53dc1709.js";import{f as ae}from"./index-cd09e6dc.js";import"./plugin-49832ae5.js";import"./icon-d6196121.js";import"./_arrayMap-23a2d4b9.js";import"./tables_list-a7382472.js";import"./http-6ded690c.js";import"./SettingItemBox-35417b6f.js";/* empty css                                                                   */import"./CollapseItem-fd18501b.js";const ce=(t,e,o,i)=>{const r=t,a=e,n={width:1,height:1},c=parseFloat((r/a).toFixed(5)),d=()=>{const V=parseFloat((window.innerWidth/window.innerHeight).toFixed(5));o&&(V>c?(n.width=parseFloat((window.innerHeight*c/r).toFixed(5)),n.height=parseFloat((window.innerHeight/a).toFixed(5)),o.style.transform=`scale(${n.width}, ${n.height})`):(n.height=parseFloat((window.innerWidth/c/a).toFixed(5)),n.width=parseFloat((window.innerWidth/r).toFixed(5)),o.style.transform=`scale(${n.width}, ${n.height})`),i&&i(n))},l=_(()=>{d()},200);return{calcRate:d,windowResize:()=>{window.addEventListener("resize",l)},unWindowResize:()=>{window.removeEventListener("resize",l)}}},de=(t,e,o,i)=>{const r=t,a=e,n={width:1,height:1},c=parseFloat((r/a).toFixed(5)),d=()=>{o&&(n.height=parseFloat((window.innerWidth/c/a).toFixed(5)),n.width=parseFloat((window.innerWidth/r).toFixed(5)),o.style.transform=`scale(${n.width}, ${n.height})`,i&&i(n))},l=_(()=>{d()},200);return{calcRate:d,windowResize:()=>{window.addEventListener("resize",l)},unWindowResize:()=>{window.removeEventListener("resize",l)}}},le=(t,e,o,i)=>{const r=t,a=e,n={height:1,width:1},c=parseFloat((r/a).toFixed(5)),d=()=>{o&&(n.width=parseFloat((window.innerHeight*c/r).toFixed(5)),n.height=parseFloat((window.innerHeight/a).toFixed(5)),o.style.transform=`scale(${n.width}, ${n.height})`,i&&i(n))},l=_(()=>{d()},200);return{calcRate:d,windowResize:()=>{window.addEventListener("resize",l)},unWindowResize:()=>{window.removeEventListener("resize",l)}}},he=(t,e,o,i)=>{const r={width:1,height:1},a=()=>{o&&(r.width=parseFloat((window.innerWidth/t).toFixed(5)),r.height=parseFloat((window.innerHeight/e).toFixed(5)),o.style.transform=`scale(${r.width}, ${r.height})`,i&&i(r))},n=_(()=>{a()},200);return{calcRate:a,windowResize:()=>{window.addEventListener("resize",n)},unWindowResize:()=>{window.removeEventListener("resize",n)}}},M=(t,e)=>({zIndex:e+1,left:`${t.x}px`,top:`${t.y}px`}),Q=(t,e)=>({width:`${e?e*t.w:t.w}px`,height:`${e?e*t.h:t.h}px`}),U=t=>({display:t.hide?"none":"block"}),ue=t=>{const e=t.selectColor?{background:t.background}:{background:`url(${t.backgroundImage}) center center / cover no-repeat !important`};return h({position:"relative",width:t.width?`${t.width||100}px`:"100%",height:t.height?`${t.height}px`:"100%"},e)};const we=C({__name:"index",props:{groupData:{type:Object,required:!0},themeSetting:{type:Object,required:!0},themeColor:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(t){return(e,o)=>(u(!0),w(A,null,P(t.groupData.groupList,i=>(u(),w("div",{class:R(["chart-item",s(H)(i.styles.animations)]),key:i.id,style:f(h(h(h(h(h({},s(M)(i.attr,t.groupIndex)),s(x)(i.styles)),s(G)(i.styles)),s(U)(i.status)),s(q)(i.styles)))},[(u(),y(j(i.chartConfig.chartKey),B({chartConfig:i,themeSetting:t.themeSetting,themeColor:t.themeColor,style:h({},s(Q)(i.attr))},N(s(K)(i))),null,16,["chartConfig","themeSetting","themeColor","style"]))],6))),128))}});var pe=S(we,[["__scopeId","data-v-684f3f90"]]);const ge=C({__name:"index",props:{localStorageInfo:{type:Object,required:!0}},setup(t){const e=t,o=m(()=>e.localStorageInfo.editCanvasConfig.chartThemeSetting),i=m(()=>{const r=e.localStorageInfo.editCanvasConfig.chartThemeColor;return ie[r]});return(r,a)=>(u(!0),w(A,null,P(t.localStorageInfo.componentList,(n,c)=>(u(),w("div",{class:R(["chart-item",s(H)(n.styles.animations)]),key:n.id,style:f(h(h(h(h(h({},s(M)(n.attr,c)),s(x)(n.styles)),s(G)(n.styles)),s(U)(n.status)),s(q)(n.styles)))},[n.isGroup?(u(),y(s(pe),{key:0,groupData:n,groupIndex:c,themeSetting:s(o),themeColor:s(i)},null,8,["groupData","groupIndex","themeSetting","themeColor"])):(u(),y(j(n.chartConfig.chartKey),B({key:1,chartConfig:n,themeSetting:s(o),themeColor:s(i),style:h({},s(Q)(n.attr))},N(s(K)(n))),null,16,["chartConfig","themeSetting","themeColor","style"]))],6))),128))}});var T=S(ge,[["__scopeId","data-v-56cc7537"]]);const ve=t=>{const e=p(!1),o=setInterval(()=>{if(window.$vue.component){clearInterval(o);const i=r=>{window.$vue.component(r.chartConfig.chartKey)||window.$vue.component(r.chartConfig.chartKey,ae(r.chartConfig))};t.componentList.forEach(r=>I(void 0,null,function*(){r.isGroup?r.groupList.forEach(a=>{i(a)}):i(r)})),e.value=!0}},200);return{show:e}},fe=t=>{const e=p(),o=p(),i=p(t.editCanvasConfig.width),r=p(t.editCanvasConfig.height);return ee(()=>{switch(t.editCanvasConfig.previewScaleType){case g.FIT:(()=>{const{calcRate:a,windowResize:n,unWindowResize:c}=ce(i.value,r.value,o.value);a(),n(),v(()=>{c()})})();break;case g.SCROLL_Y:(()=>{const{calcRate:a,windowResize:n,unWindowResize:c}=de(i.value,r.value,o.value,d=>{const l=e.value;l.style.width=`${i.value*d.width}px`,l.style.height=`${r.value*d.height}px`});a(),n(),v(()=>{c()})})();break;case g.SCROLL_X:(()=>{const{calcRate:a,windowResize:n,unWindowResize:c}=le(i.value,r.value,o.value,d=>{const l=e.value;l.style.width=`${i.value*d.width}px`,l.style.height=`${r.value*d.height}px`});a(),n(),v(()=>{c()})})();break;case g.FULL:(()=>{const{calcRate:a,windowResize:n,unWindowResize:c}=he(i.value,r.value,o.value);a(),n(),v(()=>{c()})})();break}}),{entityRef:e,previewRef:o}},ye=t=>{const e=re();e.requestGlobalConfig=t[se.REQUEST_GLOBAL_CONFIG]};const me=C({__name:"index",setup(t){const e=O(),o=m(()=>h(h({},ue(e.editCanvasConfig)),x(e.editCanvasConfig))),i=m(()=>{const c=e.editCanvasConfig.previewScaleType;return c===g.SCROLL_Y||c===g.SCROLL_X});ye(e);const{entityRef:r,previewRef:a}=fe(e),{show:n}=ve(e);return(c,d)=>(u(),w("div",{class:R(`go-preview ${s(e).editCanvasConfig.previewScaleType}`)},[s(i)?(u(),w("div",{key:0,ref_key:"entityRef",ref:r,class:"go-preview-entity"},[te("div",{ref_key:"previewRef",ref:a,class:"go-preview-scale"},[s(n)?(u(),w("div",{key:0,style:f(s(o))},[b(s(T),{localStorageInfo:s(e)},null,8,["localStorageInfo"])],4)):k("",!0)],512)],512)):(u(),w("div",{key:1,ref_key:"previewRef",ref:a,class:"go-preview-scale"},[s(n)?(u(),w("div",{key:0,style:f(s(o))},[b(s(T),{localStorageInfo:s(e)},null,8,["localStorageInfo"])],4)):k("",!0)],512))],2))}});var _e=S(me,[["__scopeId","data-v-559a6a9b"]]);const Oe=C({__name:"wrapper",setup(t){let e=p(Date.now()),o=O();return[W.JSON,W.CHART].forEach(i=>{!window.opener||window.opener.addEventListener(i,r=>{ne(oe.GO_CHART_STORAGE_LIST,[E(h({},r.detail),{id:o.id})]),e.value=Date.now()})}),(i,r)=>(u(),y(_e,{key:s(e)}))}});export{Oe as default};
